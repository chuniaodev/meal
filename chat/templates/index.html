<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
    <title>Tornado Chat Demo</title>
    <!-- <link rel="stylesheet" href="{{ static_url("chat.css") }}" type="text/css"/> -->
    <style>
        /* #html { overflow-x: hidden; overflow-y: auto; }
           style="position: relative; top: expression(this.offsetParent.scrollTop);"     */
        #body {
         /* position: absolute;*/
        }
        .viewdiv{
            float:right;
            width:200px;
            border:1px
            /* solid red*/
        }
    </style>
  </head>
  <body>
      <div id="main">
      <table id="main_table" border="1" cellpadding="1" cellspacing="1" width="100%" >
          <tbody>
          <tr width="%100">
              <td align="right" width="%100">
                <div id="nav">
                  <a href="/auth/logout">{{ _("Sign out") }}</a>
                </div>
              </td>
          </tr>
    </table>
    </div>

    <div id=body>    
      <table id="main_table" border="1" cellpadding="1" cellspacing="1" width="100%" height="500">
          <tbody>
          <tr>
              <!-- 左侧,chat -->
              <td width="%40" valign="bottom">
                <div id="body">
                  <div id="inbox">
                    {% for message in messages %}
                      {% module Template("message.html", message=message) %}
                    {% end %}
                  </div>
                  <div id="input">
                    <form action="/a/message/new" method="post" id="messageform">
                      <table border="2" cellpadding="1" cellspacing="1" >
                        <tr>

                        </tr>
                        <tr>
                          <td>
                              <input type="hidden" name="mesgReqFlag" id="mesgReqFlagID" value="ON"/>
                              <input type="hidden" name="username" id="usernameid" value="{{ user["userchname"] }}"/>
                                {{ user["userchname"] }}:<input name="body" id="message" style="width:300px"/>
                          </td>
                          <td style="padding-left:5px">
                            <input type="submit" value="{{ _("Post") }}"/>
                            <input type="hidden" name="next" value="{{ request.path }}"/>
                            {% module xsrf_form_html() %}
                          </td>
                        </tr>
                      </table>
                    </form>
                  </div>
                </div>
              </td>
              
              <!-- 中间列,点餐面板 -->
              <td width="%30" valign="top" align="center" >
                  <table id="mid_table" height="60%">
                      <tbody>
                      <tr>
                          <td >
                            青龙鼎丰电话:59426023,15330296023<br>菜单:<br>
                            <form action="/a/menu/new" method="post" id="menuform">
                                <input type="hidden" name="username" id="usernameid" value="{{ user["userchname"] }}"/>
                                <input type="hidden" name="userid" id="userid" value="{{ user["username"] }}"/>
                                <input type="hidden" name="menuReqFlag" id="menuReqFlagID" value="ON"/>
                                <select name="menuid" id="menunameid" >
                                      {% for menu in menus %}
                                         {% module Template("menu.html", menu=menu) %}
                                      {% end %}
                                </select>
                                <input type="submit" value="{{ _("点餐") }}"/>
                                <input type="hidden" name="next" value="{{ request.path }}"/>
                                    {% module xsrf_form_html() %}
                            </form>
                        </td>
                     </tr>
                    <tr>
                        <td>
                        <br>
                            {{ user["userchname"] }}&nbsp;总金额:&nbsp;
                            <div class="viewdiv" id="personmenusumid">{{ user["personmenusum"] }}</div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                        <br>
                        总金额:<div class="viewdiv" id="menusumid">{{ user["menusum"] }}</div>
                    </tr>
                    <tr>
                        <td>
                        <br>
                        总数量:<div class="viewdiv" id="menunumid">{{ user["menunum"] }}</div>
                        </td>
                    </tr>
                  </tbody>
                </table>
              </td>
              
              <!-- 右侧, 个人面板-->
              <td width="%30" valign="top">
                      今日菜单:(暂不支持删除，请选择好之后点餐!)<br>
                      <div id="inmenubox">
                          {% for menu in mlists %}
                             {% module Template("mlist.html", menu=menu) %}
                          {% end %}
                      </div>
              </td>
          </tr>
          </tbody>
      </table>
      </div> 
    <script type="text/javascript">
//        function chang_menu()
//        {
//            var priceid = "price" + document.getElementById("menuid").value) + "id" ;
//            var nameid = "name" + document.getElementById("menuid").value) + "id" ;
//            alert("priceid:" priceid + "-----" + "nameid:"nameid);
//        }

//        function setCookie(c_name,value,expiredays)
//        {
//        var exdate=new Date()
//        exdate.setDate(exdate.getDate()+expiredays)
//        document.cookie=c_name+ "=" +escape(value)+
//        ((expiredays==null) ? "" : ";expires="+exdate.toGMTString())
//        }
//
//        setCookie("user","AAA",365);
//
//        function getCookie(c_name)
//        {
//            if (document.cookie.length>0)
//            {
//                c_start=document.cookie.indexOf(c_name + "=")
//                    if (c_start!=-1)
//                    { 
//                        c_start=c_start + c_name.length+1 
//                            c_end=document.cookie.indexOf(";",c_start)
//                            if (c_end==-1) c_end=document.cookie.length
//                                return unescape(document.cookie.substring(c_start,c_end))
//                    } 
//            }
//            return ""
//        }
//
//        alert(getCookie("user"));
//        document.getElementById("username").value = getCookie("user");

        function disable_menu(mdiv)
        {
            var menudiv = document.getElementById(mdiv);
            //alert("menudiv:" + menudiv.id);
            menudiv.style.display = "none";
        }
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js" type="text/javascript"></script>
    <script src="{{ static_url("chat.js") }}" type="text/javascript"></script>
  </body>
</html>
